/*
 * Output.cu
 *
 *  Created on: Feb 1, 2018
 *      Author: joseph
 */

#ifndef OUTPUT_CU_
#define OUTPUT_CU_



#include "Layer.cu"

namespace BC {

class FeedForward : Layer<FeedForward> {

public:
	vec y;

	//operator == is a delayed evaluation assignment operator
	FeedForward(int inputs, int outputs) : y(outputs) {}

	template<class T> auto forwardPropagation(vec_expr<T> in) {
		y = in;
		return in.eval();
	}
	template<class T> auto forwardPropagation_Express(vec_expr<T> x) const {
		return x.eval();
	}

	template<class T> auto backPropagation(vec_expr<T> dy) {
		return y - dy;
	}

	void updateWeights() {
		w += w_gradientStorage * lr;
		b += b_gradientStorage * lr;
	}
	void clearBPStorage() {
		w_gradientStorage.zero();
		b_gradientStorage.zero();
	}

};
}



#endif /* OUTPUT_CU_ */
